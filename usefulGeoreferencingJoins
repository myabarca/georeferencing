# result set represents specimens with locality info 
SELECT * FROM lot
INNER JOIN locality ON lot.locationID = locality.locationID; 


# joining locality + georef + lot
# get 6253 records
SELECT
  lot.institutionCode,
  lot.collectionCode,
  lot.basisOfRecord,
  lot.occurrenceID,
  lot.scientificName,
  lot.taxonRank,
  lot.catalogNumber,
  lot.individualCount,
  lot.locationID,
  locality.recordedBy,
  locality.verbatimEventDate,
  locality.continent,
  locality.waterBody,
  locality.islandGroup,
  locality.island,
  locality.country,
  locality.stateProvince,
  locality.county,
  locality.earliestEonOrLowestEonothem,
  locality.latestEonOrHighestEonothem,
  locality.earliestEraOrLowestErathem,
  locality.latestEraOrHighestErathem,
  locality.earliestPeriodOrLowestSystem,
  locality.latestPeriodOrHighestSystem,
  locality.earliestEpochOrLowestSeries,
  locality.latestEpochOrHighestSeries,
  locality.earliestAgeOrLowestStage,
  locality.latestAgeOrHighestStage,
  locality.group,
  locality.formation,
  locality.member,
  locality.bed,
  georeference.decimalLatitude,
  georeference.decimalLongitude,
  georeference.geodeticDatum,
  georeference.coordinateUncertaintyInMeters
 FROM locality 
 INNER JOIN lot
 ON locality.locationID = lot.locationID
 INNER JOIN georeference ON georeference.locationID = lot.locationID;

# switching order of the tables gives same result of 6253 records 
# result set represents specimens that have a locality that is georeferenced
SELECT
  lot.institutionCode,
  lot.collectionCode,
  lot.basisOfRecord,
  lot.occurrenceID,
  lot.scientificName,
  lot.taxonRank,
  lot.catalogNumber,
  lot.individualCount,
  lot.locationID,
  locality.recordedBy,
  locality.verbatimEventDate,
  locality.continent,
  locality.waterBody,
  locality.islandGroup,
  locality.island,
  locality.country,
  locality.stateProvince,
  locality.county,
  locality.earliestEonOrLowestEonothem,
  locality.latestEonOrHighestEonothem,
  locality.earliestEraOrLowestErathem,
  locality.latestEraOrHighestErathem,
  locality.earliestPeriodOrLowestSystem,
  locality.latestPeriodOrHighestSystem,
  locality.earliestEpochOrLowestSeries,
  locality.latestEpochOrHighestSeries,
  locality.earliestAgeOrLowestStage,
  locality.latestAgeOrHighestStage,
  locality.group,
  locality.formation,
  locality.member,
  locality.bed,
  georeference.decimalLatitude,
  georeference.decimalLongitude,
  georeference.geodeticDatum,
  georeference.coordinateUncertaintyInMeters
 FROM locality 
 INNER JOIN lot
 ON locality.locationID = lot.locationID
 INNER JOIN georeference ON georeference.locationID = lot.locationID;

# this way also works
# get 6253 records again
SELECT
	lot.catalogNumber,
	locality.locationID,
    locality.county,
    locality.stateProvince,
    georeference.decimalLongitude,
    georeference.decimalLatitude
FROM lot, locality, georeference
WHERE
lot.locationID = locality.locationID AND 
locality.locationID = georeference.locationID; 

## for result set that has localities that are georeferenced 
## get 1575 records, which is size of georeference table so all good
SELECT
	locality.locationID,
    locality.county,
    locality.stateProvince,
    georeference.decimalLongitude,
    georeference.decimalLatitude
FROM locality
INNER JOIN georeference
ON locality.locationID = georeference.locationID;
